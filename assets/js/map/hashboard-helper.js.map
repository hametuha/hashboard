{"version":3,"sources":["hashboard-helper.js"],"names":["$","fileContainer","document","on","e","preventDefault","this","parents","toggleClass","name","attr","files","length","fr","FileReader","onload","event","target","result","readAsDataURL","$form","method","toUpperCase","action","params","find","each","index","input","$input","val","addClass","hbRest","done","response","Materialize","toast","message","trigger","fail","responseJSON","always","removeClass","avatar_url","get","reset","$button","hasClass","remove","ready","material_select","handleStatus","$statusBox","endpoint","success","text","form","jQuery"],"mappings":"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","file":"../hashboard-helper.js","sourcesContent":["/**\n * Description\n */\n\n/*global Hashboard: false*/\n/*global Materialize: false*/\n\n(function ($) {\n  'use strict';\n\n  var fileContainer = {};\n\n  $(document).on('click', '.hb-submenu-trigger', function(e){\n    e.preventDefault();\n    $(this).parents('.hb-menu-item').toggleClass('toggle');\n  });\n\n  // File data store.\n  $(document).on('change', '.hb-form input[type=file]', function(e){\n    var name = $(this).attr('name');\n    if(!this.files.length){\n      if ( fileContainer[name]){\n        fileContainer[name] = null;\n      }\n      return;\n    }\n    var fr = new FileReader();\n    fr.onload = function(event){\n      fileContainer[name] = event.target.result;\n    };\n    fr.readAsDataURL(this.files[0]);\n  });\n\n  // Form handler\n  $(document).on('submit', '.hb-form', function(e){\n    e.preventDefault();\n    var $form  = $(this);\n    var method = $form.attr('method').toUpperCase();\n    var action = $form.attr('action');\n    var params = {};\n    $form.find('input,select,textarea').each(function(index, input){\n      var $input = $(input);\n      if(!$input.attr('name')){\n        return true;\n      }\n      switch($(input).attr('type')){\n        case 'checkbox':\n        case 'radio':\n          if($input.attr('checked')){\n            params[$input.attr('name')] = $input.val();\n          }\n          break;\n        case 'file':\n          params[$input.attr('name')] = fileContainer[$input.attr('name')];\n          break;\n        default:\n          params[$input.attr('name')] = $input.val();\n          break;\n      }\n    });\n    $form.addClass('loading');\n    $.hbRest(method, action, params).done(function(response){\n      Materialize.toast('<span><i class=\"material-icons success\">done</i>' + response.message + '</span>', 4000);\n      $(document).trigger('updated.form.hashboard', [$form, response]);\n    }).fail(function(response){\n      Materialize.toast('<span><i class=\"material-icons error\">error</i>' + response.responseJSON.message + '</span>', 4000);\n    }).always(function(){\n      $form.removeClass('loading');\n    });\n  });\n\n  // Avatar handler.\n  $(document).on('updated.form.hashboard', function(event, $form, response){\n    switch ( $form.attr('id') ) {\n      case 'form-picture':\n        // Update profile picture\n        $form.find('.avatar').attr('src', response.avatar_url);\n        $form.get(0).reset();\n        break;\n    }\n  });\n\n\n  // Mail change handler\n  $(document).on('click', '.hb-mail-resend, .hb-mail-cancel', function(e){\n    e.preventDefault();\n    var $button = $(this);\n    var method = $button.hasClass('hb-mail-resend') ? 'PUT' : 'DELETE';\n    var $form  = $button.parents('form');\n    $form.addClass('loading');\n    $.hbRest( method, $(this).attr('href') ).done(function(response){\n      if ( 'DELETE' === method ) {\n        $button.parents('.hb-warning').remove();\n      }\n      Materialize.toast('<span><i class=\"material-icons success\">done</i>' + response.message + '</span>', 4000);\n    }).fail(function(response){\n      Materialize.toast('<span><i class=\"material-icons error\">error</i>' + response.responseJSON.message + '</span>', 4000);\n    }).always(function(){\n      $form.removeClass('loading');\n    });\n  });\n\n  // Initiallize slelect\n  $(document).ready(function() {\n    $('fieldset select').material_select();\n  });\n\n  var handleStatus = function( $form )  {\n    var $statusBox = $form.find('.hb-status-display');\n    // Check if box exists.\n    if ( ! $statusBox.length ) {\n      return;\n    }\n    // Check if source exists\n    var endpoint = $statusBox.attr('data-endpoint');\n    if ( ! endpoint ) {\n      return;\n    }\n    // O.K. Let's grab it.\n    $statusBox.addClass('loading loading-small');\n    $.hbRest('GET', endpoint ).done(function(response){\n      $statusBox.removeClass('success error');\n      if(response.success){\n        $statusBox.addClass('success');\n      }else{\n        $statusBox.addClass('error');\n      }\n      $statusBox.text(response.message);\n    }).fail(function(response){\n      $statusBox.addClass('error');\n      if ( response.responseJSON.message ) {\n        $statusBox.text(response.responseJSON.message);\n      }\n    }).always(function(){\n      $statusBox.removeClass('loading loading-small');\n    });\n  };\n\n  // When data is updated.\n  $(document).on('updated.form.hashboard', function(event, $form, response){\n    handleStatus($form);\n  });\n\n  // When form is displayed.\n  $(document).ready(function(){\n    $('.hb-form').each(function(index, form){\n      handleStatus( $(form) );\n    });\n  });\n\n})(jQuery);\n"]}