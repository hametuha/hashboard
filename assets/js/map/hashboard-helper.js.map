{"version":3,"sources":["hashboard-helper.js"],"names":["$","fileContainer","sideNav","onOpen","$el","addClass","onClose","el","removeClass","document","on","e","preventDefault","this","parents","toggleClass","name","attr","files","length","fr","FileReader","onload","event","target","result","readAsDataURL","$form","method","toUpperCase","action","params","find","each","index","input","$input","val","hbRest","done","response","Materialize","toast","message","trigger","fail","responseJSON","always","avatar_url","get","reset","$button","hasClass","remove","ready","material_select","handleStatus","$statusBox","endpoint","success","text","form","jQuery"],"mappings":"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","file":"../hashboard-helper.js","sourcesContent":["/**\n * Description\n */\n\n/*global Hashboard: false*/\n/*global Materialize: false*/\n\n(function ($) {\n  'use strict';\n\n  var fileContainer = {};\n\n  $(\".button-collapse\").sideNav({\n    onOpen: function($el) {\n      $('#nav-mobile' ).addClass('open initialized');\n    },\n    onClose: function(el) {\n      $('#nav-mobile' ).removeClass('open');\n    }\n  });\n\n  $(document).on('click', '.hb-submenu-trigger', function(e){\n    e.preventDefault();\n    $(this).parents('.hb-menu-item').toggleClass('toggle');\n  });\n\n  // File data store.\n  $(document).on('change', '.hb-form input[type=file]', function(e){\n    var name = $(this).attr('name');\n    if(!this.files.length){\n      if ( fileContainer[name]){\n        fileContainer[name] = null;\n      }\n      return;\n    }\n    var fr = new FileReader();\n    fr.onload = function(event){\n      fileContainer[name] = event.target.result;\n    };\n    fr.readAsDataURL(this.files[0]);\n  });\n\n  // Form handler\n  $(document).on('submit', '.hb-form', function(e){\n    e.preventDefault();\n    var $form  = $(this);\n    var method = $form.attr('method').toUpperCase();\n    var action = $form.attr('action');\n    var params = {};\n    $form.find('input,select,textarea').each(function(index, input){\n      var $input = $(input);\n      if(!$input.attr('name')){\n        return true;\n      }\n      switch($(input).attr('type')){\n        case 'checkbox':\n        case 'radio':\n          if($input.attr('checked')){\n            params[$input.attr('name')] = $input.val();\n          }\n          break;\n        case 'file':\n          params[$input.attr('name')] = fileContainer[$input.attr('name')];\n          break;\n        default:\n          params[$input.attr('name')] = $input.val();\n          break;\n      }\n    });\n    $form.addClass('loading');\n    $.hbRest(method, action, params).done(function(response){\n      Materialize.toast('<span><i class=\"material-icons success\">done</i>' + response.message + '</span>', 4000);\n      $(document).trigger('updated.form.hashboard', [$form, response]);\n    }).fail(function(response){\n      Materialize.toast('<span><i class=\"material-icons error\">error</i>' + response.responseJSON.message + '</span>', 4000);\n    }).always(function(){\n      $form.removeClass('loading');\n    });\n  });\n\n  // Avatar handler.\n  $(document).on('updated.form.hashboard', function(event, $form, response){\n    switch ( $form.attr('id') ) {\n      case 'form-picture':\n        // Update profile picture\n        $form.find('.avatar').attr('src', response.avatar_url);\n        $form.get(0).reset();\n        break;\n    }\n  });\n\n\n  // Mail change handler\n  $(document).on('click', '.hb-mail-resend, .hb-mail-cancel', function(e){\n    e.preventDefault();\n    var $button = $(this);\n    var method = $button.hasClass('hb-mail-resend') ? 'PUT' : 'DELETE';\n    var $form  = $button.parents('form');\n    $form.addClass('loading');\n    $.hbRest( method, $(this).attr('href') ).done(function(response){\n      if ( 'DELETE' === method ) {\n        $button.parents('.hb-warning').remove();\n      }\n      Materialize.toast('<span><i class=\"material-icons success\">done</i>' + response.message + '</span>', 4000);\n    }).fail(function(response){\n      Materialize.toast('<span><i class=\"material-icons error\">error</i>' + response.responseJSON.message + '</span>', 4000);\n    }).always(function(){\n      $form.removeClass('loading');\n    });\n  });\n\n  // Initiallize slelect\n  $(document).ready(function() {\n    $('fieldset select').material_select();\n  });\n\n  var handleStatus = function( $form )  {\n    var $statusBox = $form.find('.hb-status-display');\n    // Check if box exists.\n    if ( ! $statusBox.length ) {\n      return;\n    }\n    // Check if source exists\n    var endpoint = $statusBox.attr('data-endpoint');\n    if ( ! endpoint ) {\n      return;\n    }\n    // O.K. Let's grab it.\n    $statusBox.addClass('loading loading-small');\n    $.hbRest('GET', endpoint ).done(function(response){\n      $statusBox.removeClass('success error');\n      if(response.success){\n        $statusBox.addClass('success');\n      }else{\n        $statusBox.addClass('error');\n      }\n      $statusBox.text(response.message);\n    }).fail(function(response){\n      $statusBox.addClass('error');\n      if ( response.responseJSON.message ) {\n        $statusBox.text(response.responseJSON.message);\n      }\n    }).always(function(){\n      $statusBox.removeClass('loading loading-small');\n    });\n  };\n\n  // When data is updated.\n  $(document).on('updated.form.hashboard', function(event, $form, response){\n    handleStatus($form);\n  });\n\n  // When form is displayed.\n  $(document).ready(function(){\n    $('.hb-form').each(function(index, form){\n      handleStatus( $(form) );\n    });\n  });\n\n})(jQuery);\n"]}